
/*
jquery-circle-progress - jQuery Plugin to draw animated circular progress bars
URL: http://kottenator.github.io/jquery-circle-progress/
Author: Rostyslav Bryzgunov <kottenator@gmail.com>
Version: 1.1.3
License: MIT
*/
!function(a){function b(a){this.init(a)}b.prototype={value:0,size:100,startAngle:-Math.PI,thickness:"auto",fill:{gradient:["#3aeabb","#fdd250"]},emptyFill:"rgba(0, 0, 0, .1)",animation:{duration:1200,easing:"circleProgressEasing"},animationStartValue:0,reverse:!1,lineCap:"butt",constructor:b,el:null,canvas:null,ctx:null,radius:0,arcFill:null,lastFrameValue:0,init:function(b){a.extend(this,b),this.radius=this.size/2,this.initWidget(),this.initFill(),this.draw()},initWidget:function(){var b=this.canvas=this.canvas||a("<canvas>").prependTo(this.el)[0];b.width=this.size,b.height=this.size,this.ctx=b.getContext("2d")},initFill:function(){function n(){var c=a("<canvas>")[0];c.width=b.size,c.height=b.size,c.getContext("2d").drawImage(m,0,0,e,e),b.arcFill=b.ctx.createPattern(c,"no-repeat"),b.drawFrame(b.lastFrameValue)}var b=this,c=this.fill,d=this.ctx,e=this.size;if(!c)throw Error("The fill is not specified!");if(c.color&&(this.arcFill=c.color),c.gradient){var f=c.gradient;if(1==f.length)this.arcFill=f[0];else if(f.length>1){for(var g=c.gradientAngle||0,h=c.gradientDirection||[e/2*(1-Math.cos(g)),e/2*(1+Math.sin(g)),e/2*(1+Math.cos(g)),e/2*(1-Math.sin(g))],i=d.createLinearGradient.apply(d,h),j=0;j<f.length;j++){var k=f[j],l=j/(f.length-1);a.isArray(k)&&(l=k[1],k=k[0]),i.addColorStop(l,k)}this.arcFill=i}}if(c.image){var m;c.image instanceof Image?m=c.image:(m=new Image,m.src=c.image),m.complete?n():m.onload=n}},draw:function(){this.animation?this.drawAnimated(this.value):this.drawFrame(this.value)},drawFrame:function(a){this.lastFrameValue=a,this.ctx.clearRect(0,0,this.size,this.size),this.drawEmptyArc(a),this.drawArc(a)},drawArc:function(a){var b=this.ctx,c=this.radius,d=this.getThickness(),e=this.startAngle;b.save(),b.beginPath(),this.reverse?b.arc(c,c,c-d/2,e-2*Math.PI*a,e):b.arc(c,c,c-d/2,e,e+2*Math.PI*a),b.lineWidth=d,b.lineCap=this.lineCap,b.strokeStyle=this.arcFill,b.stroke(),b.restore()},drawEmptyArc:function(a){var b=this.ctx,c=this.radius,d=this.getThickness(),e=this.startAngle;1>a&&(b.save(),b.beginPath(),0>=a?b.arc(c,c,c-d/2,0,2*Math.PI):this.reverse?b.arc(c,c,c-d/2,e,e-2*Math.PI*a):b.arc(c,c,c-d/2,e+2*Math.PI*a,e),b.lineWidth=d,b.strokeStyle=this.emptyFill,b.stroke(),b.restore())},drawAnimated:function(b){var c=this,d=this.el,e=a(this.canvas);e.stop(!0,!1),d.trigger("circle-animation-start"),e.css({animationProgress:0}).animate({animationProgress:1},a.extend({},this.animation,{step:function(a){var e=c.animationStartValue*(1-a)+b*a;c.drawFrame(e),d.trigger("circle-animation-progress",[a,e])}})).promise().always(function(){d.trigger("circle-animation-end")})},getThickness:function(){return a.isNumeric(this.thickness)?this.thickness:this.size/14},getValue:function(){return this.value},setValue:function(a){this.animation&&(this.animationStartValue=this.lastFrameValue),this.value=a,this.draw()}},a.circleProgress={defaults:b.prototype},a.easing.circleProgressEasing=function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b+c:d/2*((b-=2)*b*b+2)+c},a.fn.circleProgress=function(c,d){var e="circle-progress",f=this.data(e);if("widget"==c){if(!f)throw Error('Calling "widget" method on not initialized instance is forbidden');return f.canvas}if("value"==c){if(!f)throw Error('Calling "value" method on not initialized instance is forbidden');if("undefined"==typeof d)return f.getValue();var g=arguments[1];return this.each(function(){a(this).data(e).setValue(g)})}return this.each(function(){var d=a(this),f=d.data(e),g=a.isPlainObject(c)?c:{};if(f)f.init(g);else{var h=a.extend({},d.data());"string"==typeof h.fill&&(h.fill=JSON.parse(h.fill)),"string"==typeof h.animation&&(h.animation=JSON.parse(h.animation)),g=a.extend(h,g),g.el=d,f=new b(g),d.data(e,f)}})}}(jQuery);